"0",""
"0",""
"0",""
"0","# Encontrar el primer año donde la penetración llega al 100%"
"0","early_pred_year_100 <- min(early_pred$Year[early_pred$Internet_usage >= 99.5]) # 99.5% para mayor estabilidad"
"0","late_pred_year_100  <- min(late_pred$Year[late_pred$Internet_usage >= 99.5]) # 99.5% para mayor estabilidad"
"0",""
"0","# Crear marcador en el punto donde se alcanza el 100%"
"0","early_pred_marker_point <- early_pred %>% filter(Year == early_pred_year_100)"
"0","late_pred_marker_point <- late_pred  %>% filter(Year == late_pred_year_100)"
"0",""
"0","# Graficar en Highcharter"
"0","highchart() %>%"
"0","  hc_title(text = ""Forecast of Global Internet Penetration (Logistic Growth)"") %>%"
"0","  hc_xAxis(title = list(text = ""Year"")) %>%"
"0","  hc_yAxis(title = list(text = ""Internet Usage (%)""), max = 100) %>%"
"0",""
"0","  # Datos observados"
"0","  hc_add_series(data = early_adopters %>% rename(Internet_usage = weighted_avg), type = ""line"", hcaes(x = Year, y = Internet_usage),"
"0","                name = ""Observed Data early adopters"", color = ""#1F78B4"") %>%"
"0","  hc_add_series(data = late_adopters %>% rename(Internet_usage = weighted_avg) %>% filter(Year <= 2023), type = ""line"", hcaes(x = Year, y = Internet_usage),"
"0","                name = ""Observed Data late adopters"", color = ""#1F78B4"") %>% "
"0","  "
"0",""
"0","  # Datos pronosticados (línea punteada)"
"0","  hc_add_series(data = early_pred %>% filter(Year > 2023), type = ""line"", hcaes(x = Year, y = Internet_usage),"
"0","                name = ""Forecast -  early adopters"", dashStyle = ""Dash"", color = ""#E31A1C"") %>%"
"0","  hc_add_series(data = late_pred %>% filter(Year > 2023), type = ""line"", hcaes(x = Year, y = Internet_usage),"
"0","                name = ""Forecast - late adopters"", dashStyle = ""Dash"", color = ""#E31A1C"") %>%"
"0","  "
"0","  # # Línea vertical donde empieza el pronóstico"
"0","  # hc_add_series(data = list(list(x = min(forecast_df$Year), y = 0),"
"0","  #                           list(x = min(forecast_df$Year), y = 100)),"
"0","  #               type = ""line"", name = ""Forecast Start"", color = ""black"", dashStyle = ""Dot"","
"0","  #               enableMouseTracking = FALSE, marker = list(enabled = FALSE)) %>%"
"0",""
"0","  # Punto verde en el primer año donde se alcanza el 100%"
"0","  hc_add_series(data = list(list(x = early_pred_marker_point$Year, y = early_pred_marker_point$Internet_usage)),"
"0","                type = ""scatter"", name = ""100% Internet Access - early adopters"", color = ""green"","
"0","                marker = list(symbol = ""circle"", radius = 6)) %>% "
"0","  hc_add_series(data = list(list(x = late_pred_marker_point$Year, y = late_pred_marker_point$Internet_usage)),"
"0","                type = ""scatter"", name = ""100% Internet Access - late adopters"", color = ""darkgreen"","
"0","                marker = list(symbol = ""circle"", radius = 6)) "
