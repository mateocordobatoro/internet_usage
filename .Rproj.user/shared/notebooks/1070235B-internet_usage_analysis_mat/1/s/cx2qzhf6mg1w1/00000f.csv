"0",""
"0","# Definir función logística con límite en 100%"
"0","logistic_function <- function(Year, xmid, scal) {"
"0","  100 / (1 + exp(-scal * (Year - xmid)))"
"0","}"
"0",""
"0",""
"0","prediction_log <- function(data){"
"0","  "
"0",""
"0","# Aggregating data to calculate global average per year"
"0","global_trend <- data %>%"
"0","  rename(Internet_usage = weighted_avg)"
"0",""
"0",""
"0","# Encontrar valores iniciales para los parámetros"
"0","xmid_init <- median(global_trend$Year)  # Punto de inflexión en la mitad de los datos"
"0","scal_init <- 0.1  # Velocidad de crecimiento, un valor pequeño para evitar errores"
"0",""
"0","# Ajustar el modelo logístico"
"0","logistic_model <- nls(Internet_usage ~ logistic_function(Year, xmid, scal), "
"0","                      data = global_trend, "
"0","                      start = list(xmid = xmid_init, scal = scal_init))"
"0",""
"0","# Predecir valores futuros"
"0","future_years <- data.frame(Year = seq(min(global_trend$Year), 2060, by = 1))"
"0","future_predictions <- predict(logistic_model, newdata = future_years)"
"0",""
"0","# Truncar predicciones a un máximo de 100%"
"0","future_predictions <- pmin(future_predictions, 100)"
"0",""
"0","# Crear dataframe con predicciones"
"0","forecast_df <- data.frame(Year = future_years$Year, Internet_usage = future_predictions)"
"0",""
"0",""
"0","return(forecast_df)"
"0","  "
"0","}"
"0",""
"0",""
"0","early_pred <- prediction_log(early_adopters)"
"0","late_pred <- prediction_log(late_adopters)"
"0",""
"0",""
"0",""
